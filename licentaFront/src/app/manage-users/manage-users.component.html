<div class="manage-users-wrapper">
   <h1>Manage Users</h1>

  <div *ngIf="isLoading">Loading users...</div>
  <div *ngIf="error">{{ error }}</div>

  <table *ngIf="!isLoading && users.length" class="users-table">
    <thead>
      <tr>
        <th>ID</th>
        <th>Username</th>
        <th>Address</th>
        <th>Role</th>
        <th>Contract</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let user of users">
        <td>{{ user.id }}</td>
        <td>{{ user.username }}</td>
        <td>{{ user.address }}</td>
        <td class="selection">
          <div *ngIf="editingRoleUserId !== user.id; else roleSelect">
            <span (click)="startEditingRole(user.id)">
              {{ user.role === '1' ? 'Manager' : 'User' }} â–¼
            </span>
          </div>
          <ng-template #roleSelect>
            <ng-select [items]="[{ label: 'Manager', value: '1' }, { label: 'User', value: '2' }]" bindLabel="label"
              bindValue="value" [(ngModel)]="selectedRole" (change)="assignRole(user)" (blur)="editingRoleUserId = null"
              [clearable]="false" class="custom-ng-select"></ng-select>
          </ng-template>
        </td> 
        <!-- <td class="selection">
          <div *ngIf="editingUserId !== user.id; else contractSelect">
            <span (click)="startEditing(user.id)">{{ getContractNameForUser(user.address) || 'Assign' }}</span>
          </div>
          <ng-template #contractSelect>
            <ng-select [items]="contractDropdownOptions" bindLabel="name" bindValue="id"
              [(ngModel)]="selectedContractId" (change)="assignContract(user)" (blur)="stopEditing()"
              [clearable]="false" class="custom-ng-select"></ng-select>
          </ng-template>
        </td> -->
        <td class="selection">
          <span>
            {{ getContractNameForUser(user.address) || 'No Contract Assigned' }}
          </span>
        </td>
        <td class="actions">
          <button (click)="deleteUser(user.id)" class="delete-button">Delete</button>
          
        </td>
        
      </tr>
    </tbody>
  </table> 
  <!-- <h1>Manage Users</h1>

  <div *ngIf="isLoading" class="loading-message">Loading users...</div>
  <div *ngIf="error" class="error-message">{{ error }}</div>

  <div class="grid-container" *ngIf="!isLoading && users.length">
    <ag-grid-angular
    class="ag-theme-quartz"
    [rowData]="users"
    [columnDefs]="columnDefs"
    [defaultColDef]="defaultColDef"
    [animateRows]="true"
    (cellValueChanged)="onCellValueChanged($event)">
  </ag-grid-angular>
  </div>
</div> -->
